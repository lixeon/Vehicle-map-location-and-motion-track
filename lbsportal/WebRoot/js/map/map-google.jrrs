(function(){var f=13;var b={dragend:"dragend",zoomend:"zoom_changed"};var h="map_canvas";var q="panel_map_toolbar";var j=null;var k=null;var n={};o.prototype=new google.maps.OverlayView();function o(u){this._opts=u;this._div=null;this.setMap(u.map)}o.prototype.onAdd=function(){var v=document.createElement("div");v.style.fontSize="12px";v.style.position="absolute";v.innerHTML=this._opts.content;this._div=v;var u=this.getPanes();u.overlayLayer.appendChild(v)};o.prototype.draw=function(){var v=this.getProjection();var u=v.fromLatLngToDivPixel(this._opts.position);var w=this._div;w.style.left=(u.x+this._opts.offset.x)+"px";w.style.top=(u.y+this._opts.offset.y)+"px"};o.prototype.onRemove=function(){this._div.parentNode.removeChild(this._div);this._div=null};function p(w){h=w.panelId;q=w.toolbarId;var v=$(window).width()-1*2;var x=$(window).height()-$("#panel_header").height()-2*2;$("#"+h).css({height:x+"px",width:v+"px"});$("#"+q).css({"margin-left":(v*0.618)-40*4+"px"});$("#"+q).show();var y=vp.m.adjustXY(vp.v.city_clng,vp.v.city_clat);var u={mapTypeControl:true,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE],position:google.maps.ControlPosition.TOP_LEFT,style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR},center:new google.maps.LatLng(y.y,y.x),zoom:w.zoom||f};j=new google.maps.Map(document.getElementById(h),u);$("#panel_map_legend").css({"margin-top":"40px","margin-left":"95px"})}function s(y){d(y.mkid);var A=vp.m.adjustXY(y.x,y.y);var B=new google.maps.LatLng(A.y,A.x);var u=new google.maps.Marker({id:"#MM"+y.mkid,map:j,position:B,title:y.name});var v=y.name;if(y.label){v=y.label.content}var w=new o({map:j,content:v,position:B,offset:{x:7,y:7}});if(y.center){j.panTo(B)}else{if(y.inView){var x=j.getBounds();if(!x.contains(B)){j.panTo(B)}}}if(y.infoWin){var z=new google.maps.InfoWindow({content:y.infoWin.content});google.maps.event.addListener(u,"click",function(){z.open(j,u)})}n["#MMLB"+y.mkid]=w;n["#MM"+y.mkid]=u}function d(u){e("#MM"+u);e("#MMLB"+u)}function g(x){var w=[];var y=null;for(var v=0;v<x.xs.length;v++){y=vp.m.adjustXY(x.xs[v],x.ys[v]);w.push(new google.maps.LatLng(y.y,y.x))}var u=new google.maps.Polyline({id:"#ML"+x.lid,map:j,path:w,strokeColor:x.color||"#0000ff",strokeOpacity:0.75,strokeWeight:4});n["#ML"+x.lid]=u}function i(u){e("#ML"+u)}function e(v){var u=n[v];if(u!=null){u.setMap(null);n[v]=null}}function r(u,v){$("#"+h).css({height:v+"px",width:u+"px"});$("#"+q).css({"margin-left":(u*0.618)-40*4+"px"})}function t(u,v){if(u=="zoom"){if(v==undefined){return j.getZoom()}else{j.setZoom(v)}}}function m(){var u=j.getBounds();var v={swx:u.getSouthWest().lng(),swy:u.getSouthWest().lat(),nex:u.getNorthEast().lng(),ney:u.getNorthEast().lat()};return v}function a(){for(var u in n){if(n[u]!=null){n[u].setMap(null);n[u]=null}}}function l(w,v){var u=b[w];if(u!=null){google.maps.event.addListener(j,u,v)}}function c(v,u){}vp.m.init=p;vp.m.resize=r;vp.m.showLoc=s;vp.m.removeMark=d;vp.m.drawLine=g;vp.m.removeLine=i;vp.m.mapConfig=t;vp.m.getMapBounds=m;vp.m.clearAll=a;vp.m.registerEvent=l;vp.m.unregisterEvent=c})();